<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>大樂透開獎程式</title>
  <style>
    body {
      font-family: "微軟正黑體", sans-serif;
      text-align: center;
      background-color: #f0f0f0;
      padding: 50px 20px;
    }

    h1 {
      color: #2c3e50;
    }

    #lottoNumbers {
      margin-top: 30px;
    }

    .number {
      display: inline-block;
      width: 60px;
      height: 60px;
      line-height: 60px;
      margin: 10px;
      border-radius: 50%;
      background-color: #3498db;
      color: white;
      font-size: 24px;
      font-weight: bold;
    }

    .special {
      background-color: #e74c3c;
    }

    button {
      margin-top: 20px;
      padding: 12px 30px;
      font-size: 20px;
      border: none;
      border-radius: 5px;
      background-color: #2ecc71;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      background-color: #27ae60;
    }

    #history {
      margin-top: 40px;
      text-align: center;
    }

    .record {
      margin: 10px 0;
      font-size: 18px;
    }
  </style>
</head>
<body>

  <h1>大樂透開獎模擬器</h1>

  <div id="lottoNumbers"></div>

  <button onclick="drawLotto()">開獎！</button>

  <div id="history">
    <h2>前五期開獎記錄</h2>
    <div class="record">第113000025期：03, 08, 15, 26, 33, 45 + 特別號 17</div>
    <div class="record">第113000024期：02, 10, 17, 21, 35, 38 + 特別號 12</div>
    <div class="record">第113000023期：01, 07, 19, 29, 30, 41 + 特別號 09</div>
    <div class="record">第113000022期：06, 08, 18, 22, 34, 39 + 特別號 02</div>
    <div class="record">第113000021期：05, 12, 16, 28, 32, 48 + 特別號 06</div>
  </div>

  <script>
    function drawLotto() {
      const numbers = new Set();
      while (numbers.size < 6) {
        numbers.add(Math.floor(Math.random() * 49) + 1);
      }

      const sortedNumbers = Array.from(numbers).sort((a, b) => a - b);
      const specialNumber = Math.floor(Math.random() * 49) + 1;

      const container = document.getElementById("lottoNumbers");
      container.innerHTML = '';

      sortedNumbers.forEach(num => {
        const ball = document.createElement("div");
        ball.className = "number";
        ball.textContent = num;
        container.appendChild(ball);
      });

      const special = document.createElement("div");
      special.className = "number special";
      special.textContent = specialNumber;
      container.appendChild(special);
    }
  </script>


  <div style="margin-top: 50px;">
    <h2>對獎區</h2>
    <p>請輸入你買的 6 個號碼（1~49，不可重複）：</p>
    <input type="number" id="num1" min="1" max="49" style="width:50px; font-size:16px; margin:2px;" /><input type="number" id="num2" min="1" max="49" style="width:50px; font-size:16px; margin:2px;" /><input type="number" id="num3" min="1" max="49" style="width:50px; font-size:16px; margin:2px;" /><input type="number" id="num4" min="1" max="49" style="width:50px; font-size:16px; margin:2px;" /><input type="number" id="num5" min="1" max="49" style="width:50px; font-size:16px; margin:2px;" /><input type="number" id="num6" min="1" max="49" style="width:50px; font-size:16px; margin:2px;" />
    <button onclick="checkWinning()">對獎</button>
    <div id="result" style="margin-top: 20px; font-size:18px; font-weight:bold;"></div>
    
    <h2 style="margin-top: 50px;">中獎機率（參考）</h2>
    <div style="font-size:16px;">
      <p>頭獎（6碼全中）：1 / 13,983,816</p>
      <p>貳獎（5碼+特別號）：1 / 2,330,636</p>
      <p>參獎（5碼）：1 / 55,492</p>
      <p>肆獎（4碼+特別號）：1 / 22,197</p>
      <p>伍獎（4碼）：1 / 1,032</p>
      <p>陸獎（3碼+特別號）：1 / 1,414</p>
      <p>柒獎（3碼）：1 / 57</p>
      <p>普獎（2碼+特別號）：1 / 76</p>
    </div>
  </div>

  <script>
    function checkWinning() {
      const userNums = [];
for (let i = 1; i <= 6; i++) {
  const val = parseInt(document.getElementById("num" + i).value);
  if (!isNaN(val)) userNums.push(val);
}
      const drawnNums = Array.from(document.querySelectorAll(".number:not(.special)")).map(el => parseInt(el.textContent));
      const specialNum = parseInt(document.querySelector(".number.special").textContent);
      
      if (userNums.length !== 6 || new Set(userNums).size !== 6 || userNums.some(n => n < 1 || n > 49)) {
        document.getElementById("result").textContent = "請輸入正確的 6 個號碼（1~49 且不可重複）";
        return;
      }

      let match = userNums.filter(n => drawnNums.includes(n)).length;
      let matchSpecial = userNums.includes(specialNum);
      let message = "";

      if (match === 6) {
        message = "恭喜你中頭獎！";
      } else if (match === 5 && matchSpecial) {
        message = "中貳獎（5碼+特別號）！";
      } else if (match === 5) {
        message = "中參獎（5碼）";
      } else if (match === 4 && matchSpecial) {
        message = "中肆獎（4碼+特別號）";
      } else if (match === 4) {
        message = "中伍獎（4碼）";
      } else if (match === 3 && matchSpecial) {
        message = "中陸獎（3碼+特別號）";
      } else if (match === 3) {
        message = "中柒獎（3碼）";
      } else if (match === 2 && matchSpecial) {
        message = "中普獎（2碼+特別號）";
      } else {
        message = "很可惜沒中獎～再接再厲！";
      }

      document.getElementById("result").textContent = message;


for (let i = 1; i <= 6; i++) {
  const input = document.getElementById("num" + i);
  input.addEventListener("input", function () {
    if (this.value.length === 2 && i < 6) {
      document.getElementById("num" + (i + 1)).focus();
    }
  });
}

    }

    async function loadHistory() {
      try {
        const res = await fetch('https://superiorapis.cteam.com.tw/api/lottery/649/history?limit=5');
        const data = await res.json();
        const container = document.getElementById('historyList');
        container.innerHTML = '';

        
    data.forEach(draw => {
      const div = document.createElement('div');
      div.className = 'record';

      const balls = draw.numbers.map(num => {
        return `<span class="number">${num}</span>`;
      }).join('');

      const special = `<span class="number special">${draw.special}</span>`;
      div.innerHTML = `第${draw.term}期：` + balls + special;
      container.appendChild(div);
    });
    
      } catch (e) {
        document.getElementById('historyList').textContent = '無法載入歷史紀錄，請稍後再試。';
        console.error('載入歷史紀錄失敗：', e);
      }
    }

    loadHistory();

document.querySelectorAll('input[id^="num"]').forEach(input => {
  input.addEventListener("focus", function () {
    document.getElementById("result").textContent = "";
    document.getElementById("lottoNumbers").innerHTML = "";
  });
});


document.querySelectorAll('input[id^="num"]').forEach((input, index) => {
  input.addEventListener("keydown", function(e) {
    if (e.key === "Enter") {
      checkWinning();
    }
  });
});

  </script>
</body>
</html>
